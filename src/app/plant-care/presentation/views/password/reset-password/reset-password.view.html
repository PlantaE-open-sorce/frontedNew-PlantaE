<main class="reset-page">
  <section class="reset-card">
    <div class="reset-card__top">
      <p class="reset-card__eyebrow">{{ 'iam:reset.eyebrow' | t:'Recupera tu acceso' }}</p>
      <div class="lang-toggle" *ngIf="languages.length">
        <button type="button" *ngFor="let lang of languages" [class.active]="isLang(lang)" (click)="changeLang(lang)">
          {{ lang | uppercase }}
        </button>
      </div>
    </div>
    <h1>{{ 'iam:reset.title' | t:'Restablecer contraseña' }}</h1>
    <p class="reset-card__subtitle">
      {{ 'iam:reset.subtitle' | t:'Crea una nueva contraseña para continuar.' }}
      <span class="reset-card__meta">{{ 'iam:reset.meta' | t:'El enlace expira en 15 minutos por seguridad.' }}</span>
    </p>

    <ng-container *ngIf="token; else invalid">
      <div class="reset-steps">
        <p class="reset-steps__item">
          {{ 'iam:reset.step' | t:'Usa el enlace seguro que te enviamos para definir una nueva contraseña.' }}
        </p>
      </div>

      <form [formGroup]="form" (ngSubmit)="submit()" class="reset-form">
        <label class="reset-form__field">
          <span>{{ 'iam:reset.new' | t:'Nueva contraseña' }}</span>
          <input formControlName="newPassword" type="password" placeholder="••••••••" />
        </label>
        <label class="reset-form__field">
          <span>{{ 'iam:reset.confirm' | t:'Confirmar contraseña' }}</span>
          <input formControlName="confirmPassword" type="password" placeholder="••••••••" />
        </label>
        <button class="btn btn--primary reset-form__submit" type="submit">
          {{ 'iam:reset.action' | t:'Actualizar contraseña' }}
        </button>
      </form>

      <a routerLink="/login" class="reset-link">
        {{ 'iam:reset.login' | t:'Volver al inicio de sesión' }}
      </a>
    </ng-container>

    <ng-template #invalid>
      <div class="reset-error">
        <p>{{ 'iam:reset.invalid' | t:'Este enlace no es válido o ya expiró.' }}</p>
        <a routerLink="/forgot-password" class="btn btn--primary btn--full">
          {{ 'iam:reset.request' | t:'Solicitar un nuevo enlace' }}
        </a>
      </div>
    </ng-template>
  </section>
</main>